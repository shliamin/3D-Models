<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Tent Model</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <h1>Interactive Tent Model</h1>
    <div>
        <label for="width">Width (cm):</label>
        <input type="number" id="width" value="140" step="1" min="1" onchange="updateModel()">
        <label for="depth">Depth (cm):</label>
        <input type="number" id="depth" value="230" step="1" min="1" onchange="updateModel()">
        <label for="height">Height (cm):</label>
        <input type="number" id="height" value="120" step="1" min="1" onchange="updateModel()">
    </div>
    <div id="tentModel" style="width: 100%; height: 600px;"></div>
    <div>
        <h2>Mathematical Formula</h2>
        <p>Arc coordinates calculation:</p>
        <p>\[
        x = \text{midX} + (p0_x - \text{midX}) \cdot \cos(\pi \cdot t)
        \]</p>
        <p>\[
        y = \text{midY} + (p0_y - \text{midY}) \cdot \cos(\pi \cdot t)
        \]</p>
        <p>\[
        z = \text{height} \cdot \sin(\pi \cdot t)
        \]</p>
    </div>
    <script>
        // Function to create a circular arc
        function circularArc(p0, p1, height, num_points=100) {
            let t = Array.from({length: num_points}, (_, i) => i / (num_points - 1));
            let arc = {x: [], y: [], z: []};
            
            // Midpoint coordinates between p0 and p1
            let midX = (p0[0] + p1[0]) / 2;
            let midY = (p0[1] + p1[1]) / 2;
            
            t.forEach(val => {
                let angle = Math.PI * val;
                
                // Arc coordinates calculation
                let x = midX + (p0[0] - midX) * Math.cos(angle);
                let y = midY + (p0[1] - midY) * Math.cos(angle);
                let z = height * Math.sin(angle);
                
                arc.x.push(x);
                arc.y.push(y);
                arc.z.push(z);
            });
        
            return arc;
        }

        // Function to update the tent model
        function updateModel() {
            // Get values in centimeters and convert to meters
            const width = parseFloat(document.getElementById('width').value) / 100;
            const depth = parseFloat(document.getElementById('depth').value) / 100;
            const height = parseFloat(document.getElementById('height').value) / 100;

            // Tent vertices coordinates
            let vertices = [
                [0, 0, 0],         // Bottom front left corner
                [width, 0, 0],     // Bottom front right corner
                [0, depth, 0],     // Bottom back left corner
                [width, depth, 0], // Bottom back right corner
                [width / 2, depth / 2, height]  // Top center point
            ];

            // Define faces using vertex indices
            let faces = [
                [0, 1, 4], // Front face
                [1, 3, 4], // Right face
                [3, 2, 4], // Back face
                [2, 0, 4], // Left face
                [0, 1, 3, 2] // Bottom face
            ];

            let x = [], y = [], z = [], i = [], j = [], k = [];

            // Add vertices and faces for the tent model
            vertices.forEach(v => {
                x.push(v[0]);
                y.push(v[1]);
                z.push(v[2]);
            });

            faces.forEach(face => {
                if (face.length === 3) {
                    i.push(face[0]);
                    j.push(face[1]);
                    k.push(face[2]);
                } else if (face.length === 4) {
                    i.push(face[0]);
                    j.push(face[1]);
                    k.push(face[2]);

                    i.push(face[2]);
                    j.push(face[3]);
                    k.push(face[0]);
                }
            });

            let data = [
                {
                    x: x,
                    y: y,
                    z: z,
                    i: i,
                    j: j,
                    k: k,
                    type: 'mesh3d',
                    opacity: 0.5,
                    color: 'blue'
                }
            ];

            let layout = {
                scene: {
                    xaxis: {
                        title: 'Width',
                        dtick: 0.1  // Grid step for X axis 10 cm
                    },
                    yaxis: {
                        title: 'Depth',
                        dtick: 0.1  // Grid step for Y axis 10 cm
                    },
                    zaxis: {
                        title: 'Height',
                        dtick: 0.1  // Grid step for Z axis 10 cm
                    },
                    aspectratio: {x: width, y: depth, z: height}
                },
                margin: {
                    l: 0,
                    r: 0,
                    b: 0,
                    t: 0
                }
            };

            Plotly.newPlot('tentModel', data, layout);
        }

        // Initialize the model on page load
        updateModel();
    </script>
</body>
</html>
